{% extends 'pizza/base.html' %}
{% block 'body' %}
{% load static %}
<div class="container">
    <h1>Order Pizzas</h1>
    <h2>{{ note }}</h2>

    <!--     <form id="multiplepizzaform" action="{% url 'pizzas' %}" method="post"> -->
    <form id="multiplepizzaform" action="" method="post">
        {% csrf_token %}
        {{ formset.management_form }}

        {% for form in formset %}
        {{ form }}
        <br><br>
        {% endfor %}
        <input type="submit" value="Order Pizzas">
    </form>

    <!--     <script src="{% static 'scripts/apps.js' %}"></script> -->
    <script>
        document.getElementById("multiplepizzaform").addEventListener("submit", proccess_multiple_pizzas);
        function proccess_multiple_pizzas() {
            //this code checks whether all toppings and sizes fields are empty. if so, prompts warning

            // number of pizzas from Get Pizzas button  on order.html
            let number_of_pizzas = document.getElementById("id_form-TOTAL_FORMS").value;

            // pizza elements
            let pizza_elements = ["topping1", "topping2", "size"];

            // each pizza array. this will save each field ElementById
            var each_pizza_array = [];

            for (let i = 0; i < number_of_pizzas ; i++) {
                pizza_elements.forEach(function(item) {
                    let each_pizza = "id_form-" + i + "-" + item;
                    each_pizza_array.push(document.getElementById(each_pizza).value);
                });
            }

            console.log(each_pizza_array);

            //if all fields are empty, returns true.
            function isEmpty(topping_and_size) {
                return topping_and_size == "";
            }

            console.log(each_pizza_array.every(isEmpty));

            if(each_pizza_array.every(isEmpty)) {
                alert("Fields are Empty. Please, fill them all");
            }
        }
    </script>

</div>
{% endblock%}